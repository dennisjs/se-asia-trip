<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Southeast Asia Trip</title>
  <link rel="icon" href="https://img.icons8.com/ios-filled/50/airplane-take-off.png" />
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    html, body {
      margin: 0; padding: 0; height: 100%; width: 100%;
      font-family: 'Inter', sans-serif; background: #f8f9fa;
    }
    header {
      background-color: #fff; color: #004080;
      padding: 1rem 2rem; position: fixed; top: 0; width: 100%;
      z-index: 1000; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    .nav-wrapper {
      display: flex; align-items: center; gap: 2.5rem;
    }
    .nav-wrapper h1 {
      font-size: 1.3rem; margin-right: 1.5rem;
    }
    nav a {
      color: #3366cc; text-decoration: none; font-weight: 600; font-size: 1rem;
    }
    nav a:hover {
      text-decoration: underline;
    }
    .status-info {
      font-size: 0.85rem; color: #004080;
      flex-shrink: 0; text-align: right;
    }
    .section {
      display: none; padding-top: 80px;
    }
    .active {
      display: block;
    }
    #map {
      width: 100%; height: calc(100vh - 80px);
    }
    #visited {
      padding: 2rem; max-width: 900px; margin: auto;
    }
    .day-section {
      margin-bottom: 2rem;
    }
    .day-section h3 {
      margin-bottom: 0.3rem; color: #003366;
    }
    .photos {
      display: flex; gap: 1rem; flex-wrap: wrap;
    }
    .photos img {
      width: 160px; border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .photos figcaption {
      text-align: center; font-size: 0.9rem; color: #333; margin-top: 0.3rem;
    }
  </style>
</head>
<body>
<header>
  <div class="nav-wrapper">
    <h1>SE Asia 2025</h1>
    <nav>
      <a href="#" onclick="showSection('map-section')">Map</a>
      <a href="#" onclick="showSection('visited')">Visited</a>
    </nav>
  </div>
  <div class="status-info">
    <div id="local-time">ðŸ•’ Loading time...</div>
    <div id="local-weather">â›… Loading weather...</div>
  </div>
</header>

<div id="map-section" class="section active">
  <div id="map"></div>
</div>

<div id="visited" class="section">
  <h2>Visited</h2>
  <div id="timeline-content">Loading timeline...</div>
</div>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<script>
  mapboxgl.accessToken = 'your-mapbox-token';

  function showSection(id) {
    document.querySelectorAll(".section").forEach(el => el.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }

  async function loadTimeline() {
    try {
      const response = await fetch('timeline.json');
      const timeline = await response.json();
      const container = document.getElementById('timeline-content');
      container.innerHTML = '';
      timeline.forEach(day => {
        const section = document.createElement('div');
        section.className = 'day-section';
        section.innerHTML = `<h3>${day.title}</h3><p>${day.date}</p><div class="photos">`;
        day.photos.forEach(photo => {
          const fig = document.createElement('figure');
          fig.innerHTML = `<img src="images/${photo.id}.jpg"><figcaption>${photo.caption}</figcaption>`;
          section.querySelector('.photos').appendChild(fig);
        });
        container.appendChild(section);
      });
    } catch(e) {
      document.getElementById('timeline-content').textContent = 'Failed to load timeline data.';
    }
  }

  function initializeMap() {
    const loc = {lat: 13.7417, lng: 100.5602};
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v12',
      center: [loc.lng, loc.lat],
      zoom: 12
    });
    new mapboxgl.Marker().setLngLat([loc.lng, loc.lat]).addTo(map);
  }

  function updateTimeWeather() {
    const now = new Date();
    document.getElementById('local-time').textContent = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    document.getElementById('local-weather').textContent = 'â›… 90Â°F, Humid';
  }

  window.onload = () => {
    initializeMap();
    loadTimeline();
    updateTimeWeather();
    setInterval(updateTimeWeather, 60000);
  };
</script>
</body>
</html>
